<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="%PUBLIC_URL%/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5, user-scalable=yes" />
    <meta name="theme-color" content="#000000" />
    <meta
      name="description"
      content="The Freedom Compass - Your personal financial command center. Track income, expenses, investments, and build your path to financial freedom."
    />
    <link rel="apple-touch-icon" href="%PUBLIC_URL%/logo192.png" />
    <link rel="manifest" href="%PUBLIC_URL%/manifest.json" />
    <title>The Freedom Compass - Financial Dashboard</title>
    
    <!-- ðŸ“Š GOOGLE ANALYTICS 4 - Mission-Critical Tracking -->
    <!-- SETUP INSTRUCTIONS:
         1. Go to https://analytics.google.com/
         2. Create new GA4 property for "The Freedom Compass"
         3. Get your Measurement ID (format: G-XXXXXXXXXX)
         4. Replace "G-XXXXXXXXXX" below with your actual ID
    -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      
      // ðŸŽ¯ Initialize GA4 with enhanced tracking
      gtag('config', 'G-XXXXXXXXXX', {
        'send_page_view': true,
        'anonymize_ip': true, // Privacy compliance
        'cookie_flags': 'SameSite=None;Secure'
      });
      
      // ðŸ”§ Make gtag globally accessible for event tracking
      window.gtag = gtag;
    </script>
  </head>
  <body>
    <noscript>You need to enable JavaScript to run this app.</noscript>
    <div id="root"></div>
    <script>
      // ðŸ”§ MOBILE KEYBOARD FIX - Prevent viewport jumping on iOS
      (function() {
        // Set CSS variable for viewport height (fixes iOS Safari keyboard issue)
        function setVH() {
          let vh = window.innerHeight * 0.01;
          document.documentElement.style.setProperty('--vh', `${vh}px`);
        }
        
        // Set on load
        setVH();
        
        // Update on resize
        window.addEventListener('resize', setVH);
        window.addEventListener('orientationchange', setVH);
        
        // Fix for iOS Safari - prevent body from being pushed up when keyboard appears
        document.addEventListener('focusin', function(e) {
          if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') {
            // Prevent body scroll
            document.body.style.position = 'fixed';
            document.body.style.top = `-${window.scrollY}px`;
            document.body.style.width = '100%';
          }
        });
        
        document.addEventListener('focusout', function(e) {
          if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') {
            // Restore body scroll position
            const scrollY = document.body.style.top;
            document.body.style.position = '';
            document.body.style.top = '';
            document.body.style.width = '';
            window.scrollTo(0, parseInt(scrollY || '0') * -1);
            
            // Force viewport reset
            setTimeout(() => {
              setVH();
              window.scrollTo(0, 0);
            }, 100);
          }
        });
      })();
      
      // ðŸ“± Register Service Worker for PWA functionality
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          navigator.serviceWorker.register('/sw.js')
            .then((registration) => {
              console.log('ðŸ“± SW registered: ', registration);
            })
            .catch((registrationError) => {
              console.log('ðŸ“± SW registration failed: ', registrationError);
            });
        });
      }
    </script>
  </body>
</html>